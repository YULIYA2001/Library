<div class="container my-4 pt-4" id="main-container">

  <div class="d-flex justify-content-center" style="width: 100%">
    <form class="form-inline my-2 my-lg-0 mr-sm-2">
      <input type="search" ngModel (ngModelChange)="searchGenres(key.value)" #key="ngModel"
             name="key" id="searchName" class="form-control mr-sm-2" placeholder="Поиск..." required>
    </form>
  </div>

  <div class="row">
    <div class="col-md-8">
      <div class="section-title text-center text-md-start">
        <h3 class="title mb-4">Жанры</h3>
      </div>
    </div><!--end col-->

    <div class="col-md-4 mt-4 mt-sm-0 d-md-block">
      <div class="text-right text-md-end">
        <a (click)="onOpenModal(null, 'add')" class="btn text-primary ml-0 mr-auto">Новый</a>
      </div>
    </div><!--end col-->
  </div><!--end row-->

  <div class="row">
    <div *ngFor="let genre of genres" class="col-lg-4 col-md-6 col-12 mt-4 pt-2 d-flex align-items-stretch">
      <div class="card border-0 bg-light rounded shadow">
        <div class="card-body p-4">
          <div class="mt-3 card-text">
            <h5>{{genre?.name}}</h5>
            <div id="descr-short">{{genre?.description}}</div>
          </div>
          <div class="mb-0 card-text d-flex">
            <a (click)="onOpenModal(genre, 'show')" class="btn btn-primary ml-0 mr-auto">Подробнее</a>
            <div>
              <a (click)="onOpenModal(genre, 'edit')" class="btn btn-primary mr-2 ml-auto"><i
                class="fa fa-edit"></i></a>
              <a (click)="onOpenModal(genre, 'delete')" class="btn btn-primary mr-0"><i
                class="	fa fa-trash"></i></a>
            </div>
          </div>
        </div>
      </div>
    </div><!--end col-->
  </div><!--end row-->
</div>


<!-- Add Genre Modal -->
<div class="modal fade" id="addGenreModal" tabindex="-1" role="dialog" aria-labelledby="addGenreModalLabel"
     aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="addGenreModalLabel">Добавление нового жанра</h5>
        <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form #addForm="ngForm" (ngSubmit)="onAddGenre(addForm)">
          <div class="form-group">
            <label for="name">Название жанра</label>
            <input type="text" ngModel name="name" class="form-control" id="name" placeholder="Название" required>
          </div>
          <div class="form-group">
            <label for="description">Описание жанра</label>
            <textarea rows="4" ngModel name="description" class="form-control" id="description" placeholder="Описание"
                      required></textarea>
          </div>
          <div class="modal-footer">
            <button type="button" id="add-genre-form" class="btn btn-secondary" data-bs-dismiss="modal">Закрыть</button>
            <button type="submit" class="btn btn-primary">Сохранить</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>


<!-- Edit Modal -->
<div class="modal fade" id="updateGenreModal" tabindex="-1" role="dialog" aria-labelledby="genreEditModalLabel"
     aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="updateGenreModalLabel">Изменение описания</h5>
        <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form #editForm="ngForm">
          <h6 class="text-center">{{editGenre?.name}}</h6>
          <input type="hidden" ngModel="{{editGenre?.id}}" name="id" class="form-control" id="id">
          <input type="hidden" ngModel="{{editGenre?.name}}" name="name" class="form-control" id="name2">
          <div class="form-group">
            <label for="description">Описание</label>
            <textarea rows="4" ngModel="{{editGenre?.description}}" name="description" class="form-control"
                      id="description2"></textarea>
          </div>
          <div class="modal-footer">
            <button type="button" id="" data-bs-dismiss="modal" class="btn btn-secondary">Закрыть</button>
            <button (click)="onUpdateGenre(editForm.value)" data-bs-dismiss="modal" class="btn btn-primary">Сохранить
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>


<!-- Show Detailed Genre Modal -->
<div class="modal fade" id="showGenreModal" tabindex="-1" role="dialog" aria-labelledby="genreShowModalLabel"
     aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="showGenreModalLabel">{{editGenre?.name}}</h5>
        <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="description">Описание</label>
          <p name="description" id="description3">{{editGenre?.description}}</p>
        </div>
        <div class="modal-footer">
          <button type="button" data-bs-dismiss="modal" class="btn btn-secondary">Закрыть</button>
        </div>
      </div>
    </div>
  </div>
</div>


<!-- Delete Genre Modal -->
<div class="modal fade" id="deleteGenreModal" tabindex="-1" role="dialog" aria-labelledby="deleteModelLabel"
     aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="deleteModelLabel">Удаление жанра</h5>
        <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <p>Точно хотите удалить жанр "{{deleteGenre?.name}}"?</p>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Нет</button>
          <button (click)="onDeleteGenre(deleteGenre?.id)" class="btn btn-danger" data-bs-dismiss="modal">Да</button>
        </div>
      </div>
    </div>
  </div>
</div>
